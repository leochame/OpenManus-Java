# OpenManus Java 用户指南

欢迎使用 OpenManus Java！这是一个基于LangGraph4j StateGraph架构的智能代理系统，支持Web界面和命令行两种交互方式。

## 🚀 快速开始

### 启动应用
```bash
# Web模式 (推荐)
mvn spring-boot:run

# 命令行模式
mvn spring-boot:run -Dspring-boot.run.arguments=--cli
```

### 配置要求
- 阿里云百炼API密钥 (必需)
- Docker环境 (工具执行)
- 网络连接 (搜索功能)

## 🌐 Web界面使用

### 访问方式
启动后访问: `http://localhost:8080`

### 界面布局
```
┌─────────────────────────────────────────┐
│           顶部导航栏                     │
├─────────────┬───────────────────────────┤
│  侧边栏     │        主内容区           │
│            │                           │
│ - 连接状态  │  📱 聊天 | 📊 可视化 | 📈 监控 │
│ - 任务信息  │                           │
│ - 会话历史  │                           │
└─────────────┴───────────────────────────┘
```

### 聊天功能

#### 基本使用
1. 在输入框输入问题或任务
2. 点击"发送消息"按钮 (或 Ctrl+Enter)
3. 查看AI助手回复和执行过程

#### 支持的任务类型
- **信息搜索**: "搜索Python最佳实践"
- **代码编程**: "写一个排序算法"
- **文件操作**: "创建项目文档"
- **数据分析**: "分析这个CSV文件"
- **问答对话**: "解释什么是微服务"

### 可视化功能

#### StateGraph状态图
- **绿色**: 节点执行完成
- **蓝色**: 当前执行节点
- **黄色**: 工具调用节点
- **红色**: 错误状态节点
- **箭头**: 状态转换路径

#### 思维链
- 显示StateGraph节点执行步骤
- 展示状态转换决策过程
- 追踪工具调用和状态更新
- 可视化条件路由选择

### 监控功能
- 实时状态事件
- 工具执行监控
- 系统性能指标
- 错误日志追踪

## 💻 命令行使用

### 启动和基本操作
```bash
# 启动命令行模式
mvn spring-boot:run -Dspring-boot.run.arguments=--cli

# 交互示例
👤 请输入您的任务: 搜索Java 21新特性
🤖 正在搜索...
📋 结果已整理完成

# 退出程序
👤 请输入您的任务: exit
```

### 可用命令
- **help** - 帮助信息
- **tools** - 查看工具列表
- **clear** - 清空对话
- **exit** - 退出程序

## 🏗️ StateGraph架构特性

### 状态管理
- **AgentState**: 统一管理对话状态、消息历史和工具结果
- **状态持久化**: 支持长时间对话的状态保持
- **状态回滚**: 错误时可回滚到之前的稳定状态

### 工作流编排
- **节点定义**: 思考、行动、观察等功能节点
- **条件路由**: 根据执行结果动态选择下一步
- **并行执行**: 支持多个工具的并行调用
- **错误恢复**: 内置重试和错误处理机制

### 执行流程
```
用户输入 → 思考节点 → 工具调用节点 → 观察节点 → 条件判断 → 响应生成
     ↑                                                    ↓
     └─────────────── 循环继续 ←─────────────────────────────┘
```

## 🛠️ 核心功能

### 智能搜索
```
输入: "搜索React Hooks最佳实践"
输出: 整理后的搜索结果和最佳实践建议
```

### 代码编程
```
输入: "用Python写一个计算器"
输出: 完整的计算器代码 + 使用说明
```

### 文件操作
```
输入: "创建一个项目README文件"
输出: 根据项目内容生成的README.md
```

### 数据分析
```
输入: "分析sales.csv中的销售趋势"
输出: 数据统计 + 趋势分析 + 图表说明
```

## 💡 使用技巧

### 提问技巧
- **具体明确**: "用Python写一个排序算法" ✅
- **避免模糊**: "帮我写点代码" ❌

### 任务分解
- **复杂任务**: 分解为多个简单步骤
- **文件操作**: 明确指定文件路径和格式
- **搜索任务**: 提供关键词和搜索范围

### 上下文利用
- AI会记住对话历史
- 可以继续之前的任务
- 支持多轮对话深入

## 🔧 工具说明

### 可用工具
- **Python执行器**: 运行Python代码
- **文件工具**: 读写文件操作
- **搜索工具**: 网络信息搜索
- **浏览器工具**: 网页内容提取
- **终止工具**: 结束当前任务

### 智能工具调度
StateGraph会根据当前状态和任务需求智能选择工具：
- **状态分析**: 分析当前AgentState确定所需工具
- **并行调用**: 支持多个工具同时执行
- **结果合并**: 将工具执行结果合并到状态中
- **动态路由**: 根据工具执行结果选择下一个节点

#### 工具选择策略
- 编程任务 → Python执行器节点
- 信息查询 → 搜索工具节点
- 文件处理 → 文件工具节点
- 复合任务 → 多工具并行节点

## ⚠️ 注意事项

### 安全提醒
- 代码执行在沙箱环境中
- 敏感操作需要确认
- 重要文件请提前备份

### 性能建议
- 复杂任务可能需要较长时间
- 网络搜索受网络状况影响
- 并发任务数量有限制

### 错误处理
- 任务失败会有明确提示
- 可以重新尝试或调整请求
- 查看监控面板了解详情

## ❓ 常见问题

**Q: 如何修改API密钥？**
A: 修改 `application.yml` 中的配置或设置环境变量

**Q: 为什么搜索没有结果？**
A: 检查网络连接和API密钥配置

**Q: 如何清空对话历史？**
A: Web界面点击"清空聊天"按钮，命令行输入 `clear`

**Q: 任务执行时间过长怎么办？**
A: 可以等待完成或重新启动应用

**Q: 如何查看详细错误信息？**
A: 查看Web界面的监控标签页或应用日志

## 🔗 更多资源

- **API文档**: http://localhost:8080/swagger-ui.html
- **系统监控**: http://localhost:8080/actuator/health
- **项目主页**: https://github.com/OpenManus/OpenManus-Java

---

💡 **提示**: 充分利用Web界面的可视化功能可以更好地理解AI的工作过程！