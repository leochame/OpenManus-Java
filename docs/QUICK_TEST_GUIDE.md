# 快速测试指南 - 搜索界面右侧展示

## 🎯 功能说明

当您发起搜索请求时，搜索结果页面会**自动在右侧面板展示**，无需任何额外操作。

---

## 🚀 快速测试

### 步骤 1：启动应用

```bash
cd /Users/leocham/Documents/code/Agent/OpenManus-Java
./mvnw spring-boot:run
```

### 步骤 2：访问前端

浏览器打开：`http://localhost:8089`

### 步骤 3：发起搜索测试

在聊天框中输入以下任一测试用例：

#### 测试用例 1：简单搜索
```
帮我搜索量子计算
```

**预期效果**：
- ⚡ 右侧面板立即滑入
- 💫 蓝色脉冲动画吸引注意
- 💬 顶部提示："🔍 搜索结果已在右侧展示"
- 🔍 面板标题显示"搜索结果"
- 📄 DuckDuckGo 搜索页面完整展示

#### 测试用例 2：复杂搜索
```
帮我搜索 Python 3.12 的新特性
```

**预期效果**：
- 右侧显示详细的搜索结果列表
- 可以看到多个搜索结果项
- 左侧同时显示 Agent 的文本摘要

#### 测试用例 3：搜索+访问
```
帮我搜索 React 官网，然后访问它
```

**预期效果**：
1. 首先显示 React 搜索结果页面
2. 然后自动切换到 React 官方网站
3. 标题从"🔍 搜索结果"变为"🌐 网页预览"

---

## 🎨 视觉效果说明

### 1. 面板出现动画

```
┌─────────────┐             ┌─────────────┐
│             │             │             │ ← 从右侧滑入
│   对话框    │    →       │   对话框    │ → │  搜索面板  │
│             │             │             │ ← 蓝色脉冲闪烁
└─────────────┘             └─────────────┘
```

### 2. 提示消息

```
┌──────────────────────────────────┐
│ 🔍 搜索结果已在右侧展示           │ ← 绿色成功提示
└──────────────────────────────────┘
```

### 3. 面板标题

```
┌─────────────────────────────────────────┐
│ 🔍 搜索结果  https://html.duckduckgo... │
│ [↗] [切换到VNC] [关闭]                   │
├─────────────────────────────────────────┤
│                                         │
│        DuckDuckGo 搜索结果页面           │
│                                         │
└─────────────────────────────────────────┘
```

---

## ✅ 验证清单

测试时请确认以下几点：

- [ ] 右侧面板自动出现（无需手动操作）
- [ ] 看到蓝色脉冲动画（持续约 1 秒）
- [ ] 顶部显示绿色提示消息
- [ ] 面板标题显示"🔍 搜索结果"
- [ ] iframe 中正确加载 DuckDuckGo 页面
- [ ] 可以看到实际的搜索结果列表
- [ ] 左侧对话框同时显示文本摘要
- [ ] 调试面板显示"检测到搜索，右侧展示"

---

## 🔍 对比测试

### 搜索 vs 访问网页

| 操作 | 输入 | 图标 | 标题 |
|------|------|------|------|
| 搜索 | `帮我搜索 AI` | 🔍 | 搜索结果 |
| 访问 | `帮我访问 github.com` | 🌐 | 网页预览 |

两者都会在右侧展示，但图标和标题不同。

---

## 🐛 如果没有出现右侧面板

### 检查步骤

#### 1. 打开浏览器开发者工具（F12）

查看控制台（Console）是否有错误：
```javascript
// 应该看到类似的日志：
// 检测到搜索，右侧展示: https://...
```

#### 2. 检查调试面板

点击右下角 🔧 按钮，查看调试信息：
```
[HH:MM:SS] 开始轮询沙箱状态: xxx
[HH:MM:SS] 检测到搜索，右侧展示: https://...
```

#### 3. 手动验证 URL

在控制台执行：
```javascript
console.log('显示面板:', showSandboxPanel.value);
console.log('当前URL:', currentWebUrl.value);
console.log('当前模式:', sandboxMode.value);
```

应该输出：
```
显示面板: true
当前URL: https://html.duckduckgo.com/html/?q=...
当前模式: web
```

#### 4. 查看网络请求

Network 标签中应该能看到：
- WebSocket 连接成功
- 日志消息传输

---

## 💡 常见问题

### Q1: 右侧是空白的

**原因**：DuckDuckGo 加载中或网络问题

**解决**：
1. 等待 2-3 秒
2. 查看 Network 标签是否有错误
3. 点击"在新标签页打开"按钮验证 URL

### Q2: 没有看到动画

**原因**：浏览器性能或 CSS 动画禁用

**影响**：不影响功能，只是视觉效果

**解决**：刷新页面重试

### Q3: 提示消息一闪而过

**原因**：正常行为（2-3 秒后自动消失）

**解决**：查看调试面板的历史日志

### Q4: 显示的不是搜索页面

**原因**：可能切换到了 VNC 模式

**解决**：点击"切换到网页"按钮

---

## 🔧 高级调试

### 查看完整的 WebSocket 消息

```javascript
// 在控制台执行
const originalLog = console.log;
console.log = function(...args) {
    if (args[0]?.includes?.('日志') || args[0]?.includes?.('搜索')) {
        originalLog.apply(console, ['🔍', ...args]);
    }
    originalLog.apply(console, args);
};
```

### 手动触发面板显示

```javascript
// 在控制台执行
currentWebUrl.value = 'https://html.duckduckgo.com/html/?q=test';
showSandboxPanel.value = true;
sandboxMode.value = 'web';
```

### 重置状态

```javascript
// 在控制台执行
showSandboxPanel.value = false;
currentWebUrl.value = null;
```

---

## 📊 完整测试用例集

### 基础功能
- [ ] 测试 1：简单关键词搜索
- [ ] 测试 2：中文关键词搜索
- [ ] 测试 3：英文关键词搜索
- [ ] 测试 4：包含特殊字符的搜索

### 进阶功能
- [ ] 测试 5：搜索后访问结果
- [ ] 测试 6：连续多次搜索
- [ ] 测试 7：搜索与普通访问混合
- [ ] 测试 8：切换到 VNC 模式

### 边界情况
- [ ] 测试 9：非常长的搜索关键词
- [ ] 测试 10：空格和标点符号
- [ ] 测试 11：URL 作为搜索关键词
- [ ] 测试 12：emoji 作为搜索关键词

---

## 🎓 使用技巧

### 技巧 1：同时查看两种信息

```
左侧（文本）：
- Agent 的分析和总结
- 提取的关键信息
- 推荐的链接

右侧（可视化）：
- 完整的搜索结果页面
- 实际的网页样式
- 可点击的链接
```

### 技巧 2：快速切换

```
搜索模式 → 点击搜索结果中的链接
           ↓
      自动加载新页面
           ↓
      查看详细内容
```

### 技巧 3：使用工具栏

```
[↗] - 在新标签页打开（绕过 iframe 限制）
[切换到VNC] - 使用完整浏览器（处理复杂操作）
[关闭] - 隐藏面板（专注对话）
```

---

## 📸 截图示例

### 预期效果示意图

```
┌────────────────────────────────────────────────────────┐
│  OpenManus - 深度思考系统                  [+新对话]    │
├─────────────────────────────────┬──────────────────────┤
│                                 │ 🔍 搜索结果          │
│  用户：帮我搜索量子计算           │ https://html.duck... │
│                                 │ [↗][切换][关闭]      │
│  🤖 OpenManus:                  ├──────────────────────┤
│  正在搜索...                    │                      │
│                                 │  DuckDuckGo 搜索结果  │
│  🔍 搜索结果:                   │                      │
│  1. 量子计算 - 维基百科          │  1. 量子计算 - 维基... │
│  2. 什么是量子计算？             │  2. 什么是量子计算？  │
│  3. 量子计算的应用前景           │  3. 量子计算的应用... │
│                                 │                      │
│  [正在思考中...]                │  ← iframe 实时展示   │
│                                 │                      │
└─────────────────────────────────┴──────────────────────┘
         ↑                                    ↑
    对话内容（文本）              可视化搜索页面（实际网页）
```

---

## ✅ 成功标志

如果测试成功，您应该能够：

1. ✅ 发起搜索后，右侧面板**立即**出现
2. ✅ 看到**蓝色脉冲**动画（约 1 秒）
3. ✅ 看到顶部绿色提示："**搜索结果已在右侧展示**"
4. ✅ 右侧显示**完整的 DuckDuckGo 搜索页面**
5. ✅ 左侧同时显示 Agent 的**文本分析**
6. ✅ 标题显示 **🔍 搜索结果**
7. ✅ 可以点击右上角按钮**切换模式或打开新标签**

---

## 🎉 享受新功能！

现在您可以：
- 👀 **实时看到** Agent 在搜索什么
- 📊 **完整查看** 搜索结果页面
- 🎯 **准确判断** 信息的相关性
- 🔄 **灵活切换** 不同的查看模式

开始您的搜索之旅吧！🚀

