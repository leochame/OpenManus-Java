<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OpenManus Java - æ™ºèƒ½Agentç³»ç»Ÿæ§åˆ¶å°</title>
    
    <!-- Vue.js 3 -->
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    
    <!-- Element Plus UI Library -->
    <link rel="stylesheet" href="https://unpkg.com/element-plus/dist/index.css">
    <script src="https://unpkg.com/element-plus"></script>
    
    <!-- Element Plus Icons -->
    <script src="https://unpkg.com/@element-plus/icons-vue"></script>
    
    <style>
        body {
            margin: 0;
            padding: 0;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        
        .app-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            min-height: 100vh;
        }
        
        .header {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            text-align: center;
        }
        
        .header h1 {
            margin: 0 0 15px 0;
            color: #2c3e50;
            font-size: 2.5em;
            font-weight: 700;
        }
        
        .header p {
            margin: 0;
            color: #6c757d;
            font-size: 1.2em;
            line-height: 1.6;
        }
        
        .features-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 25px;
            margin-bottom: 30px;
        }
        
        .feature-card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
            cursor: pointer;
            border: 2px solid transparent;
        }
        
        .feature-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 12px 40px rgba(0, 0, 0, 0.15);
            border-color: rgba(102, 126, 234, 0.3);
        }
        
        .feature-icon {
            font-size: 3em;
            margin-bottom: 15px;
            text-align: center;
        }
        
        .feature-title {
            font-size: 1.4em;
            font-weight: 600;
            color: #2c3e50;
            margin-bottom: 10px;
            text-align: center;
        }
        
        .feature-description {
            color: #6c757d;
            line-height: 1.6;
            text-align: center;
            margin-bottom: 15px;
        }
        
        .feature-status {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            font-size: 0.9em;
            color: #28a745;
            font-weight: 500;
        }
        
        .status-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: #28a745;
        }
        
        .info-panel {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            text-align: center;
        }
        
        .info-title {
            font-size: 1.3em;
            font-weight: 600;
            color: #2c3e50;
            margin-bottom: 15px;
        }
        
        .info-content {
            color: #6c757d;
            line-height: 1.6;
        }
        
        .quick-actions {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 20px;
            flex-wrap: wrap;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .feature-card {
            animation: fadeIn 0.6s ease-out;
        }
        
        .feature-card:nth-child(1) { animation-delay: 0.1s; }
         .feature-card:nth-child(2) { animation-delay: 0.2s; }
         .feature-card:nth-child(3) { animation-delay: 0.3s; }
         .feature-card:nth-child(4) { animation-delay: 0.4s; }
         .feature-card:nth-child(5) { animation-delay: 0.5s; }
         .feature-card:nth-child(6) { animation-delay: 0.6s; }
    </style>
</head>
<body>
    <div id="app">
        <div class="app-container">
            <!-- é¡µé¢å¤´éƒ¨ -->
            <div class="header">
                <h1>ğŸ¤– OpenManus Java</h1>
                <p>æ™ºèƒ½Agentç³»ç»Ÿæ§åˆ¶å° - ç»Ÿä¸€ç®¡ç†å’Œç›‘æ§æ‰€æœ‰AgentåŠŸèƒ½æ¨¡å—</p>
            </div>
            
            <!-- åŠŸèƒ½æ¨¡å—ç½‘æ ¼ -->
            <div class="features-grid">
                <!-- æ™ºèƒ½å¯¹è¯ç³»ç»Ÿ -->
                <div class="feature-card" @click="navigateTo('chat')">
                    <div class="feature-icon">ğŸ’¬</div>
                    <div class="feature-title">æ™ºèƒ½å¯¹è¯ç³»ç»Ÿ</div>
                    <div class="feature-description">
                        åŸºäºThink-Do-Reflectæ¶æ„çš„æ™ºèƒ½å¯¹è¯ç³»ç»Ÿï¼Œæ”¯æŒå¤æ‚æ¨ç†å’Œå¤šè½®å¯¹è¯
                    </div>
                    <div class="feature-status">
                        <div class="status-dot"></div>
                        ç³»ç»Ÿè¿è¡Œä¸­
                    </div>
                </div>
                
                <!-- Agentæ‰§è¡Œç›‘æ§ -->
                <div class="feature-card" @click="navigateTo('pages/agent-monitoring.html')">
                    <div class="feature-icon">ğŸ¤–</div>
                    <div class="feature-title">Agentæ‰§è¡Œç›‘æ§</div>
                    <div class="feature-description">
                        å¯è§†åŒ–ç›‘æ§Agentæ‰§è¡Œæµç¨‹ï¼Œå±•ç¤ºæ€è€ƒã€æ‰§è¡Œã€åæ€å„ä¸ªé˜¶æ®µçš„è¾“å…¥è¾“å‡ºå’ŒLLMäº¤äº’
                    </div>
                    <div class="feature-status">
                        <div class="status-dot"></div>
                        å®æ—¶ç›‘æ§
                    </div>
                </div>
                
                <!-- Think-Do-Reflectå·¥ä½œæµ -->
                <div class="feature-card" @click="navigateTo('pages/think-do-reflect.html')">
                    <div class="feature-icon">ğŸ§ </div>
                    <div class="feature-title">Think-Do-Reflectå·¥ä½œæµ</div>
                    <div class="feature-description">
                        ä¸“é—¨çš„Think-Do-Reflectå·¥ä½œæµç•Œé¢ï¼Œæ”¯æŒæ­¥éª¤åŒ–æ‰§è¡Œå’Œç»“æœå±•ç¤º
                    </div>
                    <div class="feature-status">
                        <div class="status-dot"></div>
                        å·¥ä½œæµå°±ç»ª
                    </div>
                </div>
                
                <!-- APIæ–‡æ¡£ -->
                <div class="feature-card" @click="navigateTo('swagger-ui.html')">
                    <div class="feature-icon">ğŸ“š</div>
                    <div class="feature-title">APIæ–‡æ¡£</div>
                    <div class="feature-description">
                        Swagger UIæ¥å£æ–‡æ¡£ï¼ŒæŸ¥çœ‹æ‰€æœ‰å¯ç”¨çš„REST APIæ¥å£
                    </div>
                    <div class="feature-status">
                        <div class="status-dot"></div>
                        æ–‡æ¡£å°±ç»ª
                    </div>
                </div>
                
                <!-- Agentç›‘æ§æµ‹è¯• -->
                <div class="feature-card" @click="startMonitoringTest()">
                    <div class="feature-icon">ğŸ®</div>
                    <div class="feature-title">ç›‘æ§æµ‹è¯•</div>
                    <div class="feature-description">
                        å¯åŠ¨Agentæ‰§è¡Œç›‘æ§åŠŸèƒ½çš„æ¼”ç¤ºå’Œæµ‹è¯•ï¼Œå¯åœ¨ç»Ÿä¸€ç›‘æ§ç•Œé¢æŸ¥çœ‹ç»“æœ
                    </div>
                    <div class="feature-status">
                        <div class="status-dot"></div>
                        æµ‹è¯•å°±ç»ª
                    </div>
                </div>
            </div>
            
            <!-- ç³»ç»Ÿä¿¡æ¯ -->
            <div class="info-panel">
                <div class="info-title">ğŸš€ ç³»ç»ŸçŠ¶æ€</div>
                <div class="info-content">
                    OpenManus Javaæ™ºèƒ½Agentç³»ç»Ÿæ­£åœ¨è¿è¡Œä¸­ã€‚æ‰€æœ‰åŠŸèƒ½æ¨¡å—å·²å°±ç»ªï¼Œå¯ä»¥å¼€å§‹ä½¿ç”¨ã€‚<br>
                    ç‚¹å‡»ä¸Šæ–¹åŠŸèƒ½å¡ç‰‡è¿›å…¥ç›¸åº”çš„åŠŸèƒ½æ¨¡å—ã€‚
                </div>
                <div class="quick-actions">
                    <el-button type="primary" @click="navigateTo('chat')">
                        <el-icon><ChatDotRound /></el-icon>
                        å¼€å§‹å¯¹è¯
                    </el-button>
                    <el-button type="success" @click="navigateTo('pages/agent-monitoring.html')">
                        <el-icon><Monitor /></el-icon>
                        Agentç›‘æ§
                    </el-button>
                    <el-button type="info" @click="refreshStatus">
                        <el-icon><Refresh /></el-icon>
                        åˆ·æ–°çŠ¶æ€
                    </el-button>
                </div>
            </div>
        </div>
    </div>
        
    
    <!-- Vue.js åº”ç”¨è„šæœ¬ -->
    <script>
        const { createApp } = Vue;
        const { ElMessage, ElMessageBox } = ElementPlus;
        
        createApp({
            data() {
                return {
                    systemStatus: 'running'
                };
            },
            methods: {
                navigateTo(page) {
                    if (page === 'chat') {
                        // é‡æ–°åŠ è½½å½“å‰é¡µé¢ä½œä¸ºå¯¹è¯ç³»ç»Ÿ
                        this.loadChatInterface();
                    } else {
                        // å¯¼èˆªåˆ°å…¶ä»–é¡µé¢
                        window.location.href = page;
                    }
                },
                
                loadChatInterface() {
                    // è¿™é‡Œå¯ä»¥åŠ¨æ€åŠ è½½å¯¹è¯ç•Œé¢
                    ElMessage.info('æ­£åœ¨åŠ è½½æ™ºèƒ½å¯¹è¯ç³»ç»Ÿ...');
                    // å®é™…å®ç°ä¸­å¯ä»¥é€šè¿‡AJAXåŠ è½½å¯¹è¯ç•Œé¢çš„HTML
                    setTimeout(() => {
                        window.location.reload();
                    }, 1000);
                },
                
                refreshStatus() {
                    ElMessage.success('ç³»ç»ŸçŠ¶æ€å·²åˆ·æ–°');
                    // è¿™é‡Œå¯ä»¥æ·»åŠ å®é™…çš„çŠ¶æ€æ£€æŸ¥é€»è¾‘
                },

                async startMonitoringTest() {
                    try {
                        ElMessage.info('æ­£åœ¨å¯åŠ¨ç›‘æ§æµ‹è¯•...');

                        // è°ƒç”¨ç›‘æ§æµ‹è¯•API
                        const response = await fetch('/api/agent-monitor-test/simulate-think-do-reflect', {
                            method: 'POST',
                            headers: {
                                'Content-Type': 'application/json'
                            },
                            body: JSON.stringify({
                                userInput: 'æµ‹è¯•Think-Do-Reflectå·¥ä½œæµçš„ç›‘æ§åŠŸèƒ½'
                            })
                        });

                        if (response.ok) {
                            const result = await response.json();
                            ElMessage.success(`ç›‘æ§æµ‹è¯•å·²å¯åŠ¨ï¼Œä¼šè¯ID: ${result.sessionId}`);
                            ElMessage.info('è¯·å‰å¾€ç»Ÿä¸€ç›‘æ§ç•Œé¢æŸ¥çœ‹æ‰§è¡Œè¿‡ç¨‹');

                            // 3ç§’åè‡ªåŠ¨æ‰“å¼€ç›‘æ§ç•Œé¢
                            setTimeout(() => {
                                this.navigateTo('pages/agent-monitoring.html');
                            }, 3000);
                        } else {
                            throw new Error(`HTTP ${response.status}`);
                        }
                    } catch (error) {
                        console.error('å¯åŠ¨ç›‘æ§æµ‹è¯•å¤±è´¥:', error);
                        ElMessage.error('å¯åŠ¨ç›‘æ§æµ‹è¯•å¤±è´¥: ' + error.message);
                    }
                }
            },
            
            mounted() {
                // é¡µé¢åŠ è½½å®Œæˆåçš„åˆå§‹åŒ–
                console.log('OpenManus Java æ§åˆ¶å°å·²åŠ è½½');
            }
        }).use(ElementPlus).mount('#app');
     </script>
 </body>
 </html>
                        
                        if (!response.ok) {
                            throw new Error(`HTTP error! status: ${response.status}`);
                        }
                        
                        const data = await response.json();
                        console.log("API è¿”å›æ•°æ®:", data);
                        
                        // å¤„ç†åç«¯è¿”å›çš„æ•°æ®æ ¼å¼
                        const answer = data.answer || 'æŠ±æ­‰ï¼Œæˆ‘æ— æ³•ç†è§£æ‚¨çš„é—®é¢˜ã€‚';
                        
                        // æ·»åŠ  AI å“åº” - ç¡®ä¿ä½¿ç”¨å®Œæ•´å†…å®¹
                        const messageIndex = messages.value.length;
                        
                        messages.value.push({
                            role: 'assistant',
                            content: answer,
                            answer: answer,
                            conversationId: data.conversationId,
                            timestamp: data.timestamp,
                            // å¦‚æœåç«¯è¿”å›äº†æ¨ç†ä¿¡æ¯ï¼Œä¿ç•™è¿™äº›å­—æ®µ
                            cot: data.cot || [],
                            reasoning_steps: data.reasoning_steps || [],
                            tool_calls: data.tool_calls || [],
                            observations: data.observations || [],
                            reflections: data.reflections || [],
                            iteration_count: data.iteration_count || 0
                        });
                        
                        // é»˜è®¤è®¾ç½®é•¿å›ç­”ä¸ºæŠ˜å çŠ¶æ€
                        if (isLongAnswer(messages.value[messageIndex])) {
                            expandedAnswers[messageIndex] = false;
                        }
                        
                        // éšè—æ¨ç†è¿‡ç¨‹é¢æ¿
                        hideCot();
                        
                        // æ»šåŠ¨åˆ°åº•éƒ¨
                        await nextTick();
                        scrollToBottom();
                        
                    } catch (err) {
                        console.error('å‘é€æ¶ˆæ¯æ—¶å‡ºé”™:', err);
                        
                        // å°è¯•è§£æé”™è¯¯å“åº”
                        let errorMessage = 'å‘é€æ¶ˆæ¯å¤±è´¥';
                        if (err.response) {
                            try {
                                const errorData = await err.response.json();
                                errorMessage = errorData.error || errorMessage;
                            } catch (parseErr) {
                                errorMessage = `HTTP ${err.response.status}: ${err.response.statusText}`;
                            }
                        } else {
                            errorMessage = err.message || errorMessage;
                        }
                        
                        error.value = errorMessage;
                        ElMessage.error(errorMessage);
                    } finally {
                        loading.value = false;
                    }
                };
                
                // æ»šåŠ¨åˆ°åº•éƒ¨
                const scrollToBottom = () => {
                    if (messagesContainer.value) {
                        messagesContainer.value.scrollTop = messagesContainer.value.scrollHeight;
                    }
                };

                // æ‰“å¼€é¡µé¢
                const openPage = (url) => {
                    window.open(url, '_blank');
                };

                return {
                    messages,
                    inputMessage,
                    loading,
                    error,
                    messagesContainer,
                    cotContentContainer,
                    activeCotIndex,
                    activeCotSteps,
                    activeReasoningSteps,
                    activeToolCalls,
                    activeObservations,
                    activeReflections,
                    hasDetailedInfo,
                    expandedAnswers,
                    conversationId,
                    agentInfo,
                    isLongAnswer,
                    toggleAnswer,
                    sendMessage,
                    renderMarkdown,
                    showCot,
                    hideCot,
                    startNewConversation,
                    openPage
                };
            }
        }).use(ElementPlus).mount('#app');
        
        // æ³¨å†Œ Element Plus å›¾æ ‡
        const app = createApp({});
        for (const [key, component] of Object.entries(ElementPlusIconsVue)) {
            app.component(key, component);
        }
        
        // ç¡®ä¿å›¾æ ‡ç»„ä»¶å¯ç”¨
        const {
            ChatDotRound,
            View,
            Close,
            Promotion,
            ArrowUp,
            ArrowDown,
            Plus,
            InfoFilled,
            Menu,
            BrainFilled,
            Monitor,
            DataAnalysis,
            CircleCheck
        } = ElementPlusIconsVue;
    </script>
</body>
</html>